<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Investments List</title>
    <meta name="description" content="Source code generated using layoutit.com">
    <meta name="author" content="LayoutIt!">
	  <link href="css/bootstrap.min.css" rel="stylesheet">
	  <link href="css/style.css" rel="stylesheet">
  </head>
  <body>

    <div class="container-fluid">
	<div class="row">
		<div class="col-md-12">
			<h2>
				List of Investments
			</h2>
			<h5>Total Amount Invested: <td th:text="${#numbers.formatCurrency(totalAmountInv)}"></td> </h5>
			<h5>Remaining Amount: <td th:text="${#numbers.formatCurrency(remainingAmt)}"></td> </h5>
			<table class="table table-hover table-striped">
				<thead>
					<tr>
						<th class="sortable" data-sort="id">ID</th>
						<th class="sortable" data-sort="stockName">Stock</th>
						<th class="sortable" data-sort="amountInv">Amount Invested</th>
						<th>Edit</th>
						<th>Delete</th>
					</tr>
				</thead>
				<tbody>
					<tr th:each = "stock : ${stocks}" th:data-key="${stock.amountInv + '-' + stock.stockName}">
						<td th:text="${stock.id}"></td>
						<td th:text="${stock.stockName}"></td>
						<td th:text="${#numbers.formatCurrency(stock.amountInv)}"></td>

						<td>
							<a th:href="@{'/editStock/' + ${stock.id}}" class="btn btn-primary">View/Edit</a>

						</td>
						<td>
							<a th:href="@{'/deleteStock/' + ${stock.id}}" class="btn btn-danger">Delete</a>
						</td>
					</tr>
				</tbody>
			</table>
			<a th:href="@{/addStock}" class="btn btn-success">Add Stock / Inv</a>
		</div>
	</div>
</div>

	<script src="js/jquery.min.js"></script>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<script src="js/scripts.js"></script>
  </body>
</html>

	<script>
		$(document).ready(function() {
			console.log("Document ready");
			// Click event handler for column headers
			$('.sortable').on('click', function(e) {
				e.preventDefault();
				const field = $(this).data('sort'); // Get the field to sort
				console.log("Field: ", field);
				const sortOrder = $(this).hasClass('ascending') ? 'descending' : 'ascending';

				// Toggle the class and sort arrow icon
				$('.sortable').removeClass('ascending descending');
				$(this).addClass(sortOrder);

				// Call an API endpoint to fetch sorted data and update table
				fetchSortedData(field, sortOrder);
			});

			function fetchSortedData(field, sortOrder) {
			// Make an AJAX request to API to get sorted data
				$.get('/stock/' + field + '/' + sortOrder, function(data) {
					updateTable(data);
					// Update table with sorted data
					// Now use jQuery to update table
				});
			}

			function updateTable(data) {
				var tableBody = $('.table tbody');
				tableBody.empty();
				data.forEach(function (item) {
					var row = '<tr>' +
							'<td>' + item.id + '</td>' +
							'<td>' + item.stockName + '</td>' +
							'<td>' + item.amountInv + '</td>' +
							'<td><a href="/editStock/' + item.id + '" class="btn btn-primary">View/Edit</a></td>' +
							'<td><a href="/deleteStock/' + item.id + '" class="btn btn-danger">Delete</a></td>' +
							'</tr>';
					tableBody.append(row);
				});
			}
		});
	</script>









<!--					// Function to handle the change event-->
<!--					function handleSortOptionChange() {-->
<!--						const option = sortOption.val();-->
<!--						console.log("handlesortoption change");-->
<!--						sortStocks(option);-->
<!--					}-->

<!--					// Add an event listener for the change event-->
<!--					sortOption.on('change', handleSortOptionChange);-->

<!--					// Trigger the change event when the page loads or after defining the event listener-->
<!--					handleSortOptionChange();-->

<!--					// $('#sortOption').change(function() {-->
<!--					// 	const option = $(this).val();-->
<!--					// 	sortStocks(option);-->



<!--				function sortStocks(option) {-->
<!--					console.log('option:', option);-->
<!--					const stockTable = $('.table tbody');-->
<!--					const rows = stockTable.children('tr').get();-->

<!--					rows.sort(function (a, b) {-->
<!--						const keyA = $(a).attr('data-key');-->
<!--						const keyB = $(b).attr('data-key');-->
<!--						console.log('keyA:', keyA);-->
<!--						console.log('keyB:', keyB);-->
<!--						if (option === 'amountAsc') {-->
<!--							return keyA - keyB;-->
<!--						} else if (option === 'amountDesc') {-->
<!--							return keyB - keyA;-->
<!--						} else if (option === 'nameAsc') {-->
<!--							return keyA.localeCompare(keyB);-->
<!--						} else if (option === 'nameDesc') {-->
<!--							return keyB.localeCompare(keyA);-->
<!--						}-->
<!--					});-->
<!--					stockTable.empty();-->
<!--					$.each(rows, function(index, row) {-->
<!--						stockTable.append(row);-->
<!--					});-->
<!--				}-->
<!--
			<div class = "filter-controls">
				<label for="sortOption">Sort by: </label>
				<span th:text="${selectedOption}"></span>
				<select id="sortOption">
					<option value="amountAsc">Amount (Low to High)</option>
					<option value="amountDesc">Amount (High to Low)</option>
					<option value="nameAsc">Stock Name (A to Z)</option>
					<option value="nameDesc">Stock Name (Z to A)</option>
				</select>
			</div>
 Links for changing the sorting field
			<a th:href="@{/stock?sortOption=amountAsc}">Amount (Low to High)</a>
			<a th:href="@{/stock?sortOption=amountDesc}">Amount (High to Low)</a>
			<a th:href="@{/stock?sortOption=nameAsc}">Stock Name (A to Z)</a>
			<a th:href="@{/stock?sortOption=nameDesc}">Stock Name (Z to A)</a>

-->

